let r=!1,s=!1;async function m(){try{const e=await fetch("https://fc.fis.ink/all.json",{method:"GET",headers:{Accept:"application/json","Cache-Control":"no-cache"},signal:AbortSignal.timeout(1e4)});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(e){return console.error("Failed to fetch friends circle data:",e),null}}function g(e){const t=document.getElementById("friends-num"),i=document.getElementById("active-num"),n=document.getElementById("error-num"),o=document.getElementById("article-num"),d=document.getElementById("last-updated");t&&(t.textContent=e.friends_num.toString()),i&&(i.textContent=e.active_num.toString()),n&&(n.textContent=e.error_num.toString()),o&&(o.textContent=e.article_num.toString()),d&&(d.textContent=e.last_updated_time)}function f(e){const t=document.getElementById("articles-list");if(!t)return;if(t.innerHTML="",e.length===0){x();return}e.forEach(n=>{const o=document.createElement("div");o.className="bg-white dark:bg-neutral-800 rounded-lg p-4 shadow-sm border border-neutral-200 dark:border-neutral-700 hover:shadow-md transition-shadow h-40 flex flex-col";const d=u=>{const c=document.createElement("div");return c.textContent=u,c.innerHTML};o.innerHTML=`
                <div class="flex flex-col gap-3 h-full">
                    <div class="flex items-center gap-3 flex-shrink-0">
                        <img src="${d(n.avatar)}" alt="${d(n.author)}" class="w-10 h-10 rounded-full object-cover flex-shrink-0" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHZpZXdCb3g9IjAgMCA0OCA0OCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjQiIGN5PSIyNCIgcj0iMjQiIGZpbGw9IiNGM0Y0RjYiLz4KPHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4PSIxMiIgeT0iMTIiPgo8cGF0aCBkPSJNMTIgMTJDMTQuMjA5MSAxMiAxNiAxMC4yMDkxIDE2IDhDMTYgNS43OTA5IDE0LjIwOTEgNCAxMiA0QzkuNzkwODYgNCA4IDUuNzkwOSA4IDhDOCAxMC4yMDkxIDkuNzkwODYgMTIgMTIgMTJaIiBmaWxsPSIjOUNBM0FGIi8+CjxwYXRoIGQ9Ik0xMiAxNEM5LjMzIDEzLjk5IDcuMDEgMTUuNzQgNiAxOC4yNFYyMEgxOFYxOC4yNEMxNi45OSAxNS43NCAxNC42NyAxMy45OSAxMiAxNFoiIGZpbGw9IiM5Q0EzQUYiLz4KPC9zdmc+Cjwvc3ZnPgo='">
                        <div class="flex-1 min-w-0">
                            <div class="font-medium text-neutral-900 dark:text-white text-sm truncate">${d(n.author)}</div>
                            <div class="text-xs text-neutral-500 dark:text-neutral-400">${d(n.created)}</div>
                        </div>
                        <a href="${d(n.link)}" target="_blank" rel="noopener noreferrer" class="flex-shrink-0 p-1 text-neutral-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                            </svg>
                        </a>
                    </div>
                    <h3 class="text-base font-medium text-neutral-800 dark:text-neutral-200 line-clamp-3 leading-relaxed flex-1 overflow-hidden">
                        <a href="${d(n.link)}" target="_blank" rel="noopener noreferrer" class="hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
                            ${d(n.title)}
                        </a>
                    </h3>
                </div>
            `,t.appendChild(o)});const i=document.getElementById("articles-container");i&&i.classList.remove("hidden")}function h(){const e=document.getElementById("loading"),t=document.getElementById("error"),i=document.getElementById("articles-container"),n=document.getElementById("no-articles");e&&e.classList.remove("hidden"),t&&t.classList.add("hidden"),i&&i.classList.add("hidden"),n&&n.classList.add("hidden")}function I(){const e=document.getElementById("loading"),t=document.getElementById("error"),i=document.getElementById("articles-container"),n=document.getElementById("no-articles");e&&e.classList.add("hidden"),t&&t.classList.remove("hidden"),i&&i.classList.add("hidden"),n&&n.classList.add("hidden")}function x(){const e=document.getElementById("loading"),t=document.getElementById("error"),i=document.getElementById("articles-container"),n=document.getElementById("no-articles");e&&e.classList.add("hidden"),t&&t.classList.add("hidden"),i&&i.classList.add("hidden"),n&&n.classList.remove("hidden")}async function l(){if(r)return;r=!0,h();const e=await m();if(e){g(e.statistical_data),f(e.article_data);const t=document.getElementById("loading");t&&t.classList.add("hidden")}else I();r=!1}function M(){if(s)return;const e=document.getElementById("retry-btn");e&&e.addEventListener("click",l),s=!0,l()}function a(){(window.location.pathname==="/circle/"||window.location.pathname==="/circle")&&(s=!1,setTimeout(M,100))}document.addEventListener("DOMContentLoaded",a);document.addEventListener("astro:page-load",a);window.addEventListener("popstate",a);document.readyState==="loading"?document.addEventListener("DOMContentLoaded",a):a();
