let r=!1,s=!1;async function u(){try{const e=await fetch("https://fc.fis.ink/all.json",{method:"GET",headers:{Accept:"application/json","Cache-Control":"no-cache"},signal:AbortSignal.timeout(1e4)});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(e){return console.error("Failed to fetch friends circle data:",e),null}}function g(e){const t=document.getElementById("friends-num"),i=document.getElementById("active-num"),n=document.getElementById("error-num"),o=document.getElementById("article-num"),a=document.getElementById("last-updated");t&&(t.textContent=e.friends_num.toString()),i&&(i.textContent=e.active_num.toString()),n&&(n.textContent=e.error_num.toString()),o&&(o.textContent=e.article_num.toString()),a&&(a.textContent=e.last_updated_time)}function h(e){const t=document.getElementById("articles-list");if(!t)return;if(t.innerHTML="",e.length===0){M();return}e.forEach(n=>{const o=document.createElement("div");o.className="bg-white dark:bg-neutral-800 rounded-lg p-4 shadow-sm border border-neutral-200 dark:border-neutral-700 hover:shadow-md transition-shadow";const a=m=>{const c=document.createElement("div");return c.textContent=m,c.innerHTML};o.innerHTML=`
                <div class="flex items-start gap-4">
                    <img src="${a(n.avatar)}" alt="${a(n.author)}" class="w-12 h-12 rounded-full object-cover flex-shrink-0" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHZpZXdCb3g9IjAgMCA0OCA0OCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjQiIGN5PSIyNCIgcj0iMjQiIGZpbGw9IiNGM0Y0RjYiLz4KPHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4PSIxMiIgeT0iMTIiPgo8cGF0aCBkPSJNMTIgMTJDMTQuMjA5MSAxMiAxNiAxMC4yMDkxIDE2IDhDMTYgNS43OTA5IDE0LjIwOTEgNCAxMiA0QzkuNzkwODYgNCA4IDUuNzkwOSA4IDhDOCAxMC4yMDkxIDkuNzkwODYgMTIgMTIgMTJaIiBmaWxsPSIjOUNBM0FGIi8+CjxwYXRoIGQ9Ik0xMiAxNEM5LjMzIDEzLjk5IDcuMDEgMTUuNzQgNiAxOC4yNFYyMEgxOFYxOC4yNEMxNi45OSAxNS43NCAxNC42NyAxMy45OSAxMiAxNFoiIGZpbGw9IiM5Q0EzQUYiLz4KPC9zdmc+Cjwvc3ZnPgo='">
                    <div class="flex-1 min-w-0">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="font-medium text-neutral-900 dark:text-white">${a(n.author)}</span>
                            <span class="text-sm text-neutral-500 dark:text-neutral-400">${a(n.created)}</span>
                        </div>
                        <h3 class="text-lg font-medium text-neutral-800 dark:text-neutral-200 mb-2 line-clamp-2">
                            <a href="${a(n.link)}" target="_blank" rel="noopener noreferrer" class="hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
                                ${a(n.title)}
                            </a>
                        </h3>
                    </div>
                    <a href="${a(n.link)}" target="_blank" rel="noopener noreferrer" class="flex-shrink-0 p-2 text-neutral-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                        </svg>
                    </a>
                </div>
            `,t.appendChild(o)});const i=document.getElementById("articles-container");i&&i.classList.remove("hidden")}function I(){const e=document.getElementById("loading"),t=document.getElementById("error"),i=document.getElementById("articles-container"),n=document.getElementById("no-articles");e&&e.classList.remove("hidden"),t&&t.classList.add("hidden"),i&&i.classList.add("hidden"),n&&n.classList.add("hidden")}function f(){const e=document.getElementById("loading"),t=document.getElementById("error"),i=document.getElementById("articles-container"),n=document.getElementById("no-articles");e&&e.classList.add("hidden"),t&&t.classList.remove("hidden"),i&&i.classList.add("hidden"),n&&n.classList.add("hidden")}function M(){const e=document.getElementById("loading"),t=document.getElementById("error"),i=document.getElementById("articles-container"),n=document.getElementById("no-articles");e&&e.classList.add("hidden"),t&&t.classList.add("hidden"),i&&i.classList.add("hidden"),n&&n.classList.remove("hidden")}async function l(){if(r)return;r=!0,I();const e=await u();if(e){g(e.statistical_data),h(e.article_data);const t=document.getElementById("loading");t&&t.classList.add("hidden")}else f();r=!1}function x(){if(s)return;const e=document.getElementById("retry-btn");e&&e.addEventListener("click",l),s=!0,l()}function d(){(window.location.pathname==="/circle/"||window.location.pathname==="/circle")&&(s=!1,setTimeout(x,100))}document.addEventListener("DOMContentLoaded",d);document.addEventListener("astro:page-load",d);window.addEventListener("popstate",d);document.readyState==="loading"?document.addEventListener("DOMContentLoaded",d):d();
